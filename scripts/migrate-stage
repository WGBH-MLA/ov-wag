# Commands for migrating AAPB in stage

POD=ov-wag-pr-258-backend-7db9b5f757-dztw6

k -n ov cp ~/gbh/aapb/AAPB2/collections.json $POD:collections.json
k -n ov cp docs/dev/migrate-collections.py $POD:migrate-collections.py

k -n ov cp docs/dev/migrate-exhibits.py $POD:migrate-exhibits.py
k -n ov cp ~/gbh/aapb/AAPB2/exhibits.json $POD:exhibits.json


# in pod
pip install markdown
apt update
apt install -y git
pip install git+https://github.com/WGBH-MLA/AAPB2@cmless

python manage.py migrate

# Create AAPB home page in Wagtail

# Collections
python migrate-collections.py
python manage.py shell -c '
def rename_slug(old_slug, new_slug):
    try:
        p = Page.objects.get(slug=old_slug)
        p.slug = new_slug
        p.save()
    except Page.DoesNotExist:
        print(f"Page with slug {old_slug} does not exist")

rename_slug("zoom", "zoom-collection")
rename_slug("le-show", "le-show-collection")
'

# Exhibits

python migrate-exhibits.py